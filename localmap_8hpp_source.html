<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>OpenMW: apps/openmw/mwrender/localmap.hpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenMW
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">apps/openmw/mwrender/localmap.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="localmap_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef _GAME_RENDER_LOCALMAP_H</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define _GAME_RENDER_LOCALMAP_H</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &lt;<a class="code" href="renderer_8hpp.html">openengine/ogre/renderer.hpp</a>&gt;</span>
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="preprocessor">#include &lt;OgreAxisAlignedBox.h&gt;</span>
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 <span class="keyword">namespace </span>MWWorld
<a name="l00009"></a>00009 {
<a name="l00010"></a>00010     <span class="keyword">class </span>CellStore;
<a name="l00011"></a>00011 }
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="keyword">namespace </span>MWRender
<a name="l00014"></a>00014 {
<a name="l00015"></a>00015     <span class="keyword">class </span>RenderingManager;
<a name="l00016"></a>00016 
<a name="l00020"></a><a class="code" href="classMWRender_1_1LocalMap.html">00020</a>     <span class="keyword">class </span><a class="code" href="classMWRender_1_1LocalMap.html" title="Local map rendering.">LocalMap</a>
<a name="l00021"></a>00021     {
<a name="l00022"></a>00022     <span class="keyword">public</span>:
<a name="l00023"></a>00023         <a class="code" href="classMWRender_1_1LocalMap.html#aeabb5be5ec8b8c76a09238bf295d7e77">LocalMap</a>(<a class="code" href="classOEngine_1_1Render_1_1OgreRenderer.html">OEngine::Render::OgreRenderer</a>*, <a class="code" href="classMWRender_1_1RenderingManager.html">MWRender::RenderingManager</a>* rendering);
<a name="l00024"></a>00024         <a class="code" href="classMWRender_1_1LocalMap.html#a6d6b35d27b1e1bdf6997a6f7c26b9455">~LocalMap</a>();
<a name="l00025"></a>00025 
<a name="l00032"></a>00032         <span class="keywordtype">void</span> <a class="code" href="classMWRender_1_1LocalMap.html#ae3bf4a71414822ed068ecb49bdc95889">requestMap</a> (<a class="code" href="classMWWorld_1_1CellStore.html" title="A storage struct for one single cell reference.">MWWorld::CellStore</a>* cell);
<a name="l00033"></a>00033 
<a name="l00041"></a>00041         <span class="keywordtype">void</span> <a class="code" href="classMWRender_1_1LocalMap.html#ae3bf4a71414822ed068ecb49bdc95889">requestMap</a> (<a class="code" href="classMWWorld_1_1CellStore.html" title="A storage struct for one single cell reference.">MWWorld::CellStore</a>* cell,
<a name="l00042"></a>00042                         Ogre::AxisAlignedBox bounds);
<a name="l00043"></a>00043 
<a name="l00051"></a>00051         <span class="keywordtype">void</span> <a class="code" href="classMWRender_1_1LocalMap.html#ae76ef2ffa53b658f74bbca6970b194ed">updatePlayer</a> (<span class="keyword">const</span> Ogre::Vector3&amp; position, <span class="keyword">const</span> Ogre::Quaternion&amp; orientation);
<a name="l00052"></a>00052 
<a name="l00059"></a>00059         <span class="keywordtype">void</span> <a class="code" href="classMWRender_1_1LocalMap.html#a5743e87ef1cf3acd45df4e17acd84dbf">saveFogOfWar</a>(<a class="code" href="classMWWorld_1_1CellStore.html" title="A storage struct for one single cell reference.">MWWorld::CellStore</a>* cell);
<a name="l00060"></a>00060 
<a name="l00061"></a>00061     <span class="keyword">private</span>:
<a name="l00062"></a><a class="code" href="classMWRender_1_1LocalMap.html#aa25c0e33d3e73197eef2ec588b039e37">00062</a>         <a class="code" href="classOEngine_1_1Render_1_1OgreRenderer.html">OEngine::Render::OgreRenderer</a>* <a class="code" href="classMWRender_1_1LocalMap.html#aa25c0e33d3e73197eef2ec588b039e37">mRendering</a>;
<a name="l00063"></a><a class="code" href="classMWRender_1_1LocalMap.html#a975e5ae963f23d12616c678090f8464f">00063</a>         <a class="code" href="classMWRender_1_1RenderingManager.html">MWRender::RenderingManager</a>* <a class="code" href="classMWRender_1_1LocalMap.html#a975e5ae963f23d12616c678090f8464f">mRenderingManager</a>;
<a name="l00064"></a>00064 
<a name="l00065"></a>00065         <span class="comment">// 1024*1024 pixels for a cell</span>
<a name="l00066"></a><a class="code" href="classMWRender_1_1LocalMap.html#a34072a6ba4d6f9272699ab757eaf958e">00066</a>         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classMWRender_1_1LocalMap.html#a34072a6ba4d6f9272699ab757eaf958e">sMapResolution</a> = 1024;
<a name="l00067"></a>00067 
<a name="l00068"></a>00068         <span class="comment">// the dynamic texture is a bottleneck, so don&#39;t set this too high</span>
<a name="l00069"></a><a class="code" href="classMWRender_1_1LocalMap.html#ab93760515e51d3ada845f5449465850d">00069</a>         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classMWRender_1_1LocalMap.html#ab93760515e51d3ada845f5449465850d">sFogOfWarResolution</a> = 32;
<a name="l00070"></a>00070 
<a name="l00071"></a>00071         <span class="comment">// frames to skip before rendering fog of war</span>
<a name="l00072"></a><a class="code" href="classMWRender_1_1LocalMap.html#af7b8c8a3e3f45e3d564881f2cebae83f">00072</a>         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classMWRender_1_1LocalMap.html#af7b8c8a3e3f45e3d564881f2cebae83f">sFogOfWarSkip</a> = 2;
<a name="l00073"></a>00073 
<a name="l00074"></a>00074         <span class="comment">// size of a map segment (for exteriors, 1 cell)</span>
<a name="l00075"></a><a class="code" href="classMWRender_1_1LocalMap.html#ab61f52210d0107e44faaac69e8623839">00075</a>         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classMWRender_1_1LocalMap.html#ab61f52210d0107e44faaac69e8623839">sSize</a> = 8192;
<a name="l00076"></a>00076 
<a name="l00077"></a><a class="code" href="classMWRender_1_1LocalMap.html#a400c504c68ef85179354d0724fcc4a2b">00077</a>         Ogre::Camera* <a class="code" href="classMWRender_1_1LocalMap.html#a400c504c68ef85179354d0724fcc4a2b">mCellCamera</a>;
<a name="l00078"></a><a class="code" href="classMWRender_1_1LocalMap.html#a33a26a3d3907b1e05e49636b1b0d5599">00078</a>         Ogre::SceneNode* <a class="code" href="classMWRender_1_1LocalMap.html#a33a26a3d3907b1e05e49636b1b0d5599">mCameraNode</a>;
<a name="l00079"></a><a class="code" href="classMWRender_1_1LocalMap.html#a3bcfd22e901911b473ca787557c90820">00079</a>         Ogre::SceneNode* <a class="code" href="classMWRender_1_1LocalMap.html#a3bcfd22e901911b473ca787557c90820">mCameraPosNode</a>;
<a name="l00080"></a><a class="code" href="classMWRender_1_1LocalMap.html#a63b81b7ba6b22a0efd56ba0f92129c3f">00080</a>         Ogre::SceneNode* <a class="code" href="classMWRender_1_1LocalMap.html#a63b81b7ba6b22a0efd56ba0f92129c3f">mCameraRotNode</a>;
<a name="l00081"></a>00081 
<a name="l00082"></a><a class="code" href="classMWRender_1_1LocalMap.html#a43a64cc120d64b6aef0c0cb586a8f147">00082</a>         <span class="keywordtype">float</span> <a class="code" href="classMWRender_1_1LocalMap.html#a43a64cc120d64b6aef0c0cb586a8f147">mAngle</a>;
<a name="l00083"></a>00083         <span class="keyword">const</span> Ogre::Vector2 <a class="code" href="classMWRender_1_1LocalMap.html#a84732604dff3ad497efbc9c914a94596">rotatePoint</a>(<span class="keyword">const</span> Ogre::Vector2&amp; p, <span class="keyword">const</span> Ogre::Vector2&amp; c, <span class="keyword">const</span> <span class="keywordtype">float</span> angle);
<a name="l00084"></a>00084 
<a name="l00085"></a>00085         <span class="keywordtype">void</span> <a class="code" href="classMWRender_1_1LocalMap.html#a703b321651f3dd20b6c79fcee57d2449">render</a>(<span class="keyword">const</span> <span class="keywordtype">float</span> x, <span class="keyword">const</span> <span class="keywordtype">float</span> y,
<a name="l00086"></a>00086                     <span class="keyword">const</span> <span class="keywordtype">float</span> zlow, <span class="keyword">const</span> <span class="keywordtype">float</span> zhigh,
<a name="l00087"></a>00087                     <span class="keyword">const</span> <span class="keywordtype">float</span> xw, <span class="keyword">const</span> <span class="keywordtype">float</span> yw,
<a name="l00088"></a>00088                     <span class="keyword">const</span> std::string&amp; texture);
<a name="l00089"></a>00089 
<a name="l00090"></a>00090         <span class="keywordtype">void</span> <a class="code" href="classMWRender_1_1LocalMap.html#ae2a12c6c295fb0f7c665587fc0af00e0">saveTexture</a>(<span class="keyword">const</span> std::string&amp; texname, <span class="keyword">const</span> std::string&amp; filename);
<a name="l00091"></a>00091 
<a name="l00092"></a>00092         std::string <a class="code" href="classMWRender_1_1LocalMap.html#a498c629de57fabea79d3d37961cff14a">coordStr</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> x, <span class="keyword">const</span> <span class="keywordtype">int</span> y);
<a name="l00093"></a>00093 
<a name="l00094"></a>00094         <span class="comment">// a buffer for the &quot;fog of war&quot; texture of the current cell.</span>
<a name="l00095"></a>00095         <span class="comment">// interior cells could be divided into multiple textures,</span>
<a name="l00096"></a>00096         <span class="comment">// so we store in a map.</span>
<a name="l00097"></a><a class="code" href="classMWRender_1_1LocalMap.html#af03fd2610cdb61db9802a853d1d5d67e">00097</a>         std::map &lt;std::string, std::vector&lt;Ogre::uint32&gt; &gt; <a class="code" href="classMWRender_1_1LocalMap.html#af03fd2610cdb61db9802a853d1d5d67e">mBuffers</a>;
<a name="l00098"></a>00098 
<a name="l00099"></a>00099         <span class="keywordtype">void</span> <a class="code" href="classMWRender_1_1LocalMap.html#a9afd6b3cf4306219cd1c7e1c15502592">deleteBuffers</a>();
<a name="l00100"></a>00100 
<a name="l00101"></a><a class="code" href="classMWRender_1_1LocalMap.html#a5c03a770033b005d3ba4a660bd7e98eb">00101</a>         <span class="keywordtype">bool</span> <a class="code" href="classMWRender_1_1LocalMap.html#a5c03a770033b005d3ba4a660bd7e98eb">mInterior</a>;
<a name="l00102"></a><a class="code" href="classMWRender_1_1LocalMap.html#ad55122c71856e04071fe39a444f5c4db">00102</a>         <span class="keywordtype">int</span> <a class="code" href="classMWRender_1_1LocalMap.html#a8c0692ab72870df132f73e38bd2788d0">mCellX</a>, <a class="code" href="classMWRender_1_1LocalMap.html#ad55122c71856e04071fe39a444f5c4db">mCellY</a>;
<a name="l00103"></a><a class="code" href="classMWRender_1_1LocalMap.html#adc338c988cfa8c46d9d59093bbc17103">00103</a>         Ogre::AxisAlignedBox <a class="code" href="classMWRender_1_1LocalMap.html#adc338c988cfa8c46d9d59093bbc17103">mBounds</a>;
<a name="l00104"></a><a class="code" href="classMWRender_1_1LocalMap.html#a21e5310ebb789a954095c8818e24ca67">00104</a>         std::string <a class="code" href="classMWRender_1_1LocalMap.html#a21e5310ebb789a954095c8818e24ca67">mInteriorName</a>;
<a name="l00105"></a>00105     };
<a name="l00106"></a>00106 
<a name="l00107"></a>00107 }
<a name="l00108"></a>00108 <span class="preprocessor">#endif</span>
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 20 2012 10:35:10 for OpenMW by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
